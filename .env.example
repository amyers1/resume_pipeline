# =============================================================================
# AI Resume Pipeline - Environment Configuration
# =============================================================================

# -----------------------------------------------------------------------------
# Database
# -----------------------------------------------------------------------------
# PostgreSQL Container Variables (Used by docker-compose.yml to initialize the DB)
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your-db-password
POSTGRES_DB=resume_pipeline

# -----------------------------------------------------------------------------
# RABBITMQ
# -----------------------------------------------------------------------------
ENABLE_RABBITMQ=true
RABBITMQ_HOST=your-local-api
RABBITMQ_PORT=5672
RABBITMQ_USERNAME=your-rabbitmq-username
RABBITMQ_PASSWORD=your-rabbitmq-password
RABBITMQ_VHOST=/

# -----------------------------------------------------------------------------
# Caching Configuration
# -----------------------------------------------------------------------------
# Enable/disable LLM response caching
USE_CACHE=true

# Redis cache configuration (recommended for production)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=
REDIS_CACHE_TTL_DAYS=30

# -----------------------------------------------------------------------------
# API Keys (Required)
# -----------------------------------------------------------------------------
OPENAI_API_KEY=your-openai-api-key
GOOGLE_API_KEY=your-gemini-api-key
MISTRAL_API_KEY=your-mistral-api-key

# -----------------------------------------------------------------------------
# AI Model Configuration
# -----------------------------------------------------------------------------
# Base model for most pipeline steps (analysis, matching, critique)
MODEL=gpt-5-mini # gemini-2.5-flash
# Strong model for critical steps (draft generation, refinement)
STRONG_MODEL=gpt-5

# -----------------------------------------------------------------------------
# Pipeline Configuration
# -----------------------------------------------------------------------------

# Output Configuration
OUTPUT_BACKEND=weasyprint     # 'weasyprint' or 'latex'
OUTPUT_DIR=./output
USE_CACHE=true

# Template Selection
LATEX_TEMPLATE=awesome-cv     # For 'latex' backend
TEMPLATE_NAME=resume.html.j2  # For 'weasyprint' backend

# Compile LaTeX to PDF (true/false) - only used if OUTPUT_BACKEND=latex
COMPILE_PDF=true

# Experience grouping threshold (years)
RECENT_YEARS_THRESHOLD=10

# Quality scoring thresholds
CRITIQUE_THRESHOLD=0.85
MAX_CRITIQUE_LOOPS=2

# Achievement matching parameters
TOP_K_HEURISTIC=20
TOP_K_FINAL=12

# Timezone for date stamping
TIMEZONE=America/New_York

# Escalate to strong model on second critique pass
ESCALATE_ON_SECOND_PASS=false

# -----------------------------------------------------------------------------
# Cloud Upload Configuration
# -----------------------------------------------------------------------------

# --- MinIO/S3 Compatible Storage ---
ENABLE_S3=true
S3_ENDPOINT=s3-endpoint
S3_ACCESS_KEY=s3-key-id
S3_SECRET_KEY=s3-secret-key
S3_BUCKET=s3-bucket-name
S3_SECURE=true

# --- Nextcloud/WebDAV ---
ENABLE_NEXTCLOUD=false
NEXTCLOUD_ENDPOINT=nextcloud-endpoint
NEXTCLOUD_USER=nextcloud-user
NEXTCLOUD_PASSWORD=nextcloud-password

# -----------------------------------------------------------------------------
# User/Group Configuration (for Docker)
# -----------------------------------------------------------------------------
USER_ID=1000
GROUP_ID=1000

# =============================================================================
# Frontend - Environment Configuration
# =============================================================================
# API Configuration
VITE_API_URL=/api

# ============================================================================
# LaTeX Service Configuration
# ============================================================================

# Service connection
LATEX_SERVICE_URL=http://latex-compiler:8001

# Compilation settings
LATEX_COMPILER=xelatex
LATEX_TIMEOUT=60
LATEX_COMPILE_PASSES=2
LATEX_KEEP_AUX_FILES=false

# Rate limiting
LATEX_MAX_COMPILATIONS_PER_MINUTE=5

# Versioning
LATEX_MAX_VERSIONS_PER_JOB=10

# File size limits
LATEX_MAX_FILE_SIZE_KB=500
